<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Homework #3 &#8212; MPCS 51082 - Introduction to Unix Systems  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <link rel="stylesheet" type="text/css" href="../../_static/chiweb.css?v=9805d56b" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script defer="defer" src="../../_static/rmsearch.js?v=9704a757"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          MPCS 51082</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../syllabus.html">Syllabus</a></li>
                <li><a href="../../calendar.html">Calendar</a></li>
                <li><a href="../../modules/index.html">Modules</a></li>
                <li><a href="../index.html">Assignments</a></li>
                <li><a href="../../office-hours.html">Office Hours</a></li>
                <li><a href="https://uchicago-cs.github.io/student-resource-guide/">CS Student Resources</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Homework #3</a><ul>
<li><a class="reference internal" href="#cs-linux-machine">CS Linux Machine</a></li>
<li><a class="reference internal" href="#creating-your-private-repository">Creating Your Private Repository</a></li>
<li><a class="reference internal" href="#programming-problem">Programming Problem</a><ul>
<li><a class="reference internal" href="#logging-structure">Logging Structure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#task-1-counting-users-processes">Task 1: Counting Users Processes</a><ul>
<li><a class="reference internal" href="#options">Options</a></li>
<li><a class="reference internal" href="#assumptions-hints">Assumptions/Hints</a></li>
</ul>
</li>
<li><a class="reference internal" href="#task-2-live-reload-manual-termination">Task 2: Live Reload (Manual Termination)</a><ul>
<li><a class="reference internal" href="#script-termination">Script Termination</a></li>
<li><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li><a class="reference internal" href="#helper-dir-timestamp-function">Helper: <code class="docutils literal notranslate"><span class="pre">dir_timestamp</span></code> function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#polling-loop-template">Polling loop template</a></li>
<li><a class="reference internal" href="#sample-runs">Sample Runs</a><ul>
<li><a class="reference internal" href="#test-cases">Test cases</a></li>
<li><a class="reference internal" href="#grading">Grading</a></li>
<li><a class="reference internal" href="#submission">Submission</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="sourcelink">
  <a href="../../_sources/assignments/hw3/index.rst.txt"
     rel="nofollow">Source</a>
</div>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <section id="homework-3">
<h1>Homework #3<a class="headerlink" href="#homework-3" title="Link to this heading">¶</a></h1>
<p><strong>Due: Friday October 31st at 11:59pm</strong></p>
<p>This homework is intended to give practice filtering out information from the process status command.</p>
<section id="cs-linux-machine">
<h2>CS Linux Machine<a class="headerlink" href="#cs-linux-machine" title="Link to this heading">¶</a></h2>
<p>You will need access to an Linux based machine when working on your homework assignments. You should not test your programs on macOS or
Windows Linux because these operating systems do not provide all utility commands necessary for completing this and possibly future assignments.
Additionally, if they do provide a command then it may not contain all options that a Unix-like system provides.
<strong>We will use and grade all assignments on the CS Linux machines and all programming assignments must work correctly on these machines.</strong>
However, you can work locally on a Unix or Unix-like machine but ensure that you test your final solutions on a CS Linux machine.</p>
<p>Please follow the instructions provided here</p>
<ul class="simple">
<li><p><a class="reference external" href="https://uchicago-cs.github.io/student-resource-guide/vscode/ssh.html">Using Visual Studio Code and SSH</a></p></li>
</ul>
</section>
<section id="creating-your-private-repository">
<h2>Creating Your Private Repository<a class="headerlink" href="#creating-your-private-repository" title="Link to this heading">¶</a></h2>
<p>For each assignment, a Git repository will be created for you on GitHub. However, before that repository can be created for you, you need to have a
GitHub account. If you do not yet have one, you can get an account here: <a class="reference external" href="https://github.com/join">https://github.com/join</a>.</p>
<p>To actually get your private repository, you will need this invitation URL:</p>
<ul class="simple">
<li><p><strong>HW3 invitation (Please check the Post “Homework #3 is ready” Ed)</strong></p></li>
</ul>
<p>When you click on an invitation URL, you will have to complete the following steps:</p>
<ol class="arabic simple">
<li><p>You will need to select your CNetID from a list. This will allow us to know what student is associated with each GitHub account. This step is only done for the very first invitation you accept.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are on the waiting list for this course you will not have a repository made for you until you are admitted into the course. I will post the starter code on Ed so you can work on the assignment until you are admitted into the course.</p>
</div>
<ol class="arabic simple" start="2">
<li><p>You must click “Accept this assignment” or your repository will not actually be created.</p></li>
<li><p>After accepting the assignment, Github will take a few minutes to create your repository. You should receive an email from Github when your repository is ready. Normally, it’s ready within seconds and you can just refresh the page.</p></li>
<li><dl class="simple">
<dt>You now need to clone your repository (i.e., download it to your machine).</dt><dd><ul class="simple">
<li><p>Make sure you’ve set up <a class="reference external" href="https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh">SSH access</a> on your GitHub account.</p></li>
<li><p>For each repository, you will need to get the SSH URL of the repository. To get this URL, log into GitHub and navigate to your project repository (take into account that you will have a different repository per project). Then, click on the green “Code” button, and make sure the “SSH” tab is selected. Your repository URL should look something like this: <a class="reference external" href="mailto:git&#37;&#52;&#48;github&#46;com">git<span>&#64;</span>github<span>&#46;</span>com</a>:mpcs51082-aut25/hw3-GITHUB-USERNAME.git.</p></li>
<li><p>If you do not know how to use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> to clone your repository then follow this guide that Github provides: <a class="reference external" href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository">Cloning a Repository</a></p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<p>If you run into any issues, or need us to make any manual adjustments to your registration, please let us know via Ed Discussion.</p>
</section>
<section id="programming-problem">
<h2>Programming Problem<a class="headerlink" href="#programming-problem" title="Link to this heading">¶</a></h2>
<p><strong>Note: For this assignment, you are not allowed to use the ``awk`` command. Many of you are over using this command to solve problems that can be done with simple Unix commands.</strong> However, you are allowed to use any other unix commands (except for <code class="docutils literal notranslate"><span class="pre">awk</span></code>) for this assignment, regardless if it was or was not discussed in class.</p>
<p>For this problem, you will be writing a script that filters out information coming from the <code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">aux</span></code> command (discussed in the lectures). One sample output from running this command is the following</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">USER     PID     %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span>
<span class="go">lamonts  3058393  0.0  0.0  19416  9468 ?        Ss   06:51   0:00 /lib/systemd/systemd --user</span>
<span class="go">lamonts  3058396  0.0  0.0 202588  7632 ?        S    06:51   0:00 vim test.c</span>
<span class="go">root     3080732  0.0  0.0  40724 10044 ?        Ss   09:54   0:00 sshd: lamonts [priv]</span>
<span class="go">maxg     3813528  0.0  0.0  35468  9716 pts/570  S+   Oct05   0:00 vim library.c</span>
<span class="go">maxg     3813981  0.0  0.0  19192  5484 pts/598  Ss   Oct05   0:00 -bash</span>
<span class="go">maxg     3814003  0.0  0.0  34840  9124 pts/598  S+   Oct05   0:00 vim test.c</span>
<span class="go">lamonts  3080750  0.0  0.0  40724  6984 ?        S    09:54   0:01 vim test.c</span>
<span class="go">sallyf+  3292195  0.0  0.0    544     0 pts/2661 TN   May10   0:00 grep -o -E [0-9]+</span>
<span class="go">sallyf+  3292196  0.0  0.0    392     0 pts/2661 TN   May10   0:00 head -1</span>
</pre></div>
</div>
<section id="logging-structure">
<h3>Logging Structure<a class="headerlink" href="#logging-structure" title="Link to this heading">¶</a></h3>
<p>Your task for this assignment is to implement a bash script inside the <code class="docutils literal notranslate"><span class="pre">p1/p1.sh</span></code> file that by default displays the top 10 users with the most processes inside file(s) that contain <code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">aux</span></code> output. The output will be a log entry in a <code class="docutils literal notranslate"><span class="pre">log.csv</span></code> file. The script will also produce additional warning entries in the <code class="docutils literal notranslate"><span class="pre">log.csv</span></code> file. The structure of the log file is as follows:</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>Timestamp,LogLevel,Status,Message
</pre></div>
</div>
<ol class="arabic simple">
<li><p><strong>Timestamp</strong> - Date and time of the log entry (e.g., <code class="docutils literal notranslate"><span class="pre">2024-10-19</span> <span class="pre">11:10:34</span></code>). You must use the following code <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">&quot;$(date</span> <span class="pre">+&quot;%Y-%m-%d</span> <span class="pre">%H:%M:%S&quot;)&quot;</span></code> to produce a timestamp for each entry in the log file.</p></li>
<li><p><strong>Log Level</strong>: This column can be only one of two strings: <code class="docutils literal notranslate"><span class="pre">INFO</span></code> or <code class="docutils literal notranslate"><span class="pre">WARN</span></code>. It indicates the severity or nature of the entry.</p></li>
<li><p><strong>Status</strong>: The meta-information related to the log entry. This value always be a string defined within <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> brackets. For example, <code class="docutils literal notranslate"><span class="pre">[START]</span></code>, and <code class="docutils literal notranslate"><span class="pre">[FILE=data/data02]</span></code>.</p></li>
<li><p><strong>Message</strong>: Descriptive text explaining the event that occurred.</p></li>
</ol>
<p>We will discuss the <strong>Log Level</strong>, <strong>Status</strong>, and <strong>Message</strong> columns in further details in the next section.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">p1/p1.sh</span></code> takes in a single argument that represents a directory. For example, <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">./p1.sh</span> <span class="pre">./data</span></code>. The argument <code class="docutils literal notranslate"><span class="pre">./data</span></code> is that <code class="docutils literal notranslate"><span class="pre">data</span></code> directory located in your <code class="docutils literal notranslate"><span class="pre">p1</span></code> directory in your repository. The script creates and writes to a file named <code class="docutils literal notranslate"><span class="pre">log.csv</span></code> that must be created (if it does not already exist) inside the directory specified by command line argument. For example, if the script was ran as such <code class="docutils literal notranslate"><span class="pre">./p1.sh</span> <span class="pre">./data</span></code> then the script will create the a log file located under <code class="docutils literal notranslate"><span class="pre">p1/data/log.csv</span></code>. <strong>If the log file already exists then the script will always append to the end of the log file</strong>. If a new log file is created then the above header must always be the first line in the file.</p>
<p>When the script begins to run, then the first entry must always be the following:</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>2024-10-19 11:10:34,WARN,[START],Script starting...
</pre></div>
</div>
<p><strong>Note</strong>: The <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> will be different based on when you run the script; however, everything else within the line must be exactly as shown above.</p>
</section>
</section>
<section id="task-1-counting-users-processes">
<h2>Task 1: Counting Users Processes<a class="headerlink" href="#task-1-counting-users-processes" title="Link to this heading">¶</a></h2>
<p>Your script must iterate through the provided directory and for each file inside the directory, it will create a single <code class="docutils literal notranslate"><span class="pre">INFO</span></code> log entry that represents the top 10 users with the most processes. For example,</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">p1/data/data00</span></code> file, it contains</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">USER     PID     %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span>
<span class="go">lamonts  3058393  0.0  0.0  19416  9468 ?        Ss   06:51   0:00 /lib/systemd/systemd --user</span>
<span class="go">lamonts  3058396  0.0  0.0 202588  7632 ?        S    06:51   0:00 vim test.c</span>
<span class="go">root     3080732  0.0  0.0  40724 10044 ?        Ss   09:54   0:00 sshd: lamonts [priv]</span>
<span class="go">maxg     3813528  0.0  0.0  35468  9716 pts/570  S+   Oct05   0:00 vim library.c</span>
<span class="go">maxg     3813981  0.0  0.0  19192  5484 pts/598  Ss   Oct05   0:00 grep -o -E [0-9]</span>
<span class="go">maxg     3814003  0.0  0.0  34840  9124 pts/598  S+   Oct05   0:00 vim test.c</span>
<span class="go">lamonts  3080750  0.0  0.0  40724  6984 ?        S    09:54   0:01 vim test.c</span>
<span class="go">sallyf+  3292195  0.0  0.0    544     0 pts/2661 TN   May10   0:00 grep -o -E [0-9]+</span>
<span class="go">sallyf+  3292196  0.0  0.0    392     0 pts/2661 TN   May10   0:00 head -1</span>
</pre></div>
</div>
<p>and <code class="docutils literal notranslate"><span class="pre">p1/data/data01</span></code> contains</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">USER     PID     %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span>
<span class="go">lamonts  3058393  0.0  0.0  19416  9468 ?        Ss   06:51   0:00 /lib/systemd/systemd --user</span>
</pre></div>
</div>
<p>then running the script file as such</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>chmod<span class="w"> </span>+x<span class="w"> </span>p1.sh<span class="w"> </span><span class="c1">#Make sure to make the script executable. Only needs to be done once.</span>
<span class="gp">$  </span>./p1.sh<span class="w"> </span>./data
</pre></div>
</div>
<p>will create it a <code class="docutils literal notranslate"><span class="pre">data/log.csv</span></code> (if only does not already exist) with two entries as such:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
</pre></div>
</div>
<p>For each entry, the first column contains the timestamp (<strong>Note</strong>: This will be different based on when you are running your script!). The second column will always be equal to <code class="docutils literal notranslate"><span class="pre">INFO</span></code>. The third column will always be structured as <code class="docutils literal notranslate"><span class="pre">[FILE=%s]</span></code>, where <code class="docutils literal notranslate"><span class="pre">%s</span></code> represents the file currently being processed. and the last column is structured <code class="docutils literal notranslate"><span class="pre">USER</span> <span class="pre">TOTAL_PROCESSES</span></code> where the <strong>Message</strong> output is sorted by <code class="docutils literal notranslate"><span class="pre">TOTAL_PROCESSES</span></code> in descending order. If a <code class="docutils literal notranslate"><span class="pre">USER</span></code> is tied with another <code class="docutils literal notranslate"><span class="pre">USER</span></code> then sort them by username lexicographically. Each user is separated by a single comma. <strong>The entire message string is embedded within double quotes</strong>. Do not include the <code class="docutils literal notranslate"><span class="pre">log.csv</span></code> file as an entry. If a file does produces an empty string (i.e., no list of users) then do not include a log entry for that file.</p>
<p><strong>IMPORTANT</strong>: The script file does not exit after processing the files inside of the directory. Instead, after processing all the files, it will spin in an infinite loop sleeping for 1 second (<code class="docutils literal notranslate"><span class="pre">sleep</span> <span class="pre">1</span></code>) each iteration. The user running the script must terminate the script by either entering <code class="docutils literal notranslate"><span class="pre">CTRL+C</span></code> or using <code class="docutils literal notranslate"><span class="pre">kill</span></code> to terminate the program.</p>
<section id="options">
<h3>Options<a class="headerlink" href="#options" title="Link to this heading">¶</a></h3>
<p>The script will have the following command line options that will change the output of script as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">NUMBER</span></code>: Changes the number of shown lines in the output. By default the command shows the top ten users; however, similar to the head/tail command, <code class="docutils literal notranslate"><span class="pre">-n</span></code> will only display <code class="docutils literal notranslate"><span class="pre">NUMBER</span></code> of lines to the console. You can assume number will always be a positive integer (i.e., an integer greater than zero).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">USER_1,USER_2,...,USER_N</span></code>: Excludes the usernames defined in the <code class="docutils literal notranslate"><span class="pre">USER_1,USER_2,...,USER_N</span></code> comma separated list from the output. If a <code class="docutils literal notranslate"><span class="pre">USER</span></code> is not seen in the <code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">aux</span></code> output then ignore that user.</p></li>
</ul>
</section>
<section id="assumptions-hints">
<h3>Assumptions/Hints<a class="headerlink" href="#assumptions-hints" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>You can assume we will always give exactly one command line argument that will always be a directory (i.e., <code class="docutils literal notranslate"><span class="pre">p1.sh</span> <span class="pre">/some/directory/path</span></code>). You do not have to error check for this in your script file.</p></li>
<li><p>You can assume that all files inside the directory will always contain output coming from running the <code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">aux</span></code> command. You can assume that the directory will only contain text files (i.e., no other types of files or subdirectories).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">aux</span></code> produces a lot of consecutive spaces to align the columns of its output. Use the <code class="docutils literal notranslate"><span class="pre">tr</span> <span class="pre">-s</span> <span class="pre">'</span> <span class="pre">'</span></code> command to delimit the <code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">aux</span></code> output to be a single space between each column.</p></li>
<li><p>You may want to use the <code class="docutils literal notranslate"><span class="pre">printf</span></code> command to nicely produce log entries. You can research it on your own.</p></li>
<li><p>I recommend you use a dictionary and research the <code class="docutils literal notranslate"><span class="pre">shift</span></code> command to help process command line options/arguments.</p></li>
<li><p>You can assume the options will always come before the required command line argument.</p></li>
<li><p>You can assume that we will test this giving you the correct format for an option. This means you will never see something like <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">lamont</span></code>. However, the options can come in any order and multiple can be supplied on the same command line. If given a file as input then you can assume the file will always be the last argument to <code class="docutils literal notranslate"><span class="pre">p1.sh</span></code>.</p></li>
</ol>
</section>
</section>
<section id="task-2-live-reload-manual-termination">
<h2>Task 2: Live Reload (Manual Termination)<a class="headerlink" href="#task-2-live-reload-manual-termination" title="Link to this heading">¶</a></h2>
<p>After your script finishes processing <strong>all files</strong> in the directory the first time (Task 1), it <strong>must not exit</strong>. Instead, it should:</p>
<ol class="arabic">
<li><p>Record the current “directory timestamp” (defined as the <em>maximum</em> modification time among regular files in the directory, top-level only).</p></li>
<li><dl>
<dt>Enter an infinite loop that:</dt><dd><ul class="simple">
<li><p>Sleeps for 1 second (<code class="docutils literal notranslate"><span class="pre">sleep</span> <span class="pre">1</span></code>).</p></li>
<li><p>Recomputes the directory timestamp and compares it with the previously recorded value.</p></li>
<li><p>If the timestamp <strong>increased</strong> (i.e., at least one file changed), append the warning entry</p></li>
</ul>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>%s,WARN,[RELOAD],Script reloading...
</pre></div>
</div>
<p>where <a href="#id1"><span class="problematic" id="id2">``</span></a>%s``presents the current timestamp. Then <strong>re-process the directory</strong> exactly as in Task 1, update your “last seen” timestamp, and continue looping.</p>
</dd>
</dl>
<ul class="simple">
<li><p>If <strong>no</strong> file changes are detected, continue looping (do nothing that iteration).</p></li>
</ul>
</li>
</ol>
<section id="script-termination">
<h3>Script Termination<a class="headerlink" href="#script-termination" title="Link to this heading">¶</a></h3>
<p>The script <strong>does not</strong> exit on its own. It must be terminated by the user (<code class="docutils literal notranslate"><span class="pre">CTRL+C</span></code>) or via a <code class="docutils literal notranslate"><span class="pre">kill</span></code> command.</p>
</section>
<section id="assumptions">
<h3>Assumptions<a class="headerlink" href="#assumptions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The “directory timestamp” is the <strong>maximum</strong> <code class="docutils literal notranslate"><span class="pre">mtime</span></code> (epoch seconds) among <strong>regular files in the top level</strong> of the directory (no recursion).</p></li>
<li><p>If the directory contains <strong>no</strong> regular files, treat the directory timestamp as <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
</ul>
</section>
<section id="helper-dir-timestamp-function">
<h3>Helper: <code class="docutils literal notranslate"><span class="pre">dir_timestamp</span></code> function<a class="headerlink" href="#helper-dir-timestamp-function" title="Link to this heading">¶</a></h3>
<p>Use this function to compute the directory timestamp. It supports Linux (GNU <code class="docutils literal notranslate"><span class="pre">stat</span></code>) and macOS/BSD (<code class="docutils literal notranslate"><span class="pre">stat</span> <span class="pre">-f</span></code>) and only scans the <strong>top level</strong> of the directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prints the max mtime (epoch seconds) among regular files directly in DIR,</span>
<span class="c1"># excluding the log file. Prints 0 if no files remain. Exits non-zero on error.</span>
dir_timestamp<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;usage: dir_timestamp DIR&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>

<span class="w">  </span><span class="c1"># Determine the log file&#39;s basename to exclude (default: log.csv)</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span>log_base
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">LOG_FILE</span><span class="k">:-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nv">log_base</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">LOG_FILE</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span><span class="nv">log_base</span><span class="o">=</span><span class="s2">&quot;log.csv&quot;</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span>stat<span class="w"> </span>--version<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c1"># GNU/Linux</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>max
<span class="w">    </span><span class="nv">max</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>find<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span><span class="w"> </span>-maxdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>!<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$log_base</span><span class="s2">&quot;</span><span class="w"> </span>-exec<span class="w"> </span>stat<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;%Y&#39;</span><span class="w"> </span>--<span class="w"> </span><span class="o">{}</span><span class="w"> </span>+<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-n<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-1
<span class="w">    </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">max</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span><span class="c1"># macOS / BSD</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span>max
<span class="w">    </span><span class="nv">max</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>find<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span><span class="w"> </span>-maxdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>!<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$log_base</span><span class="s2">&quot;</span><span class="w"> </span>-exec<span class="w"> </span>stat<span class="w"> </span>-f<span class="w"> </span><span class="s1">&#39;%m&#39;</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span>+<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="se">\</span>
<span class="w">      </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-n<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-1
<span class="w">    </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">max</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="o">}</span>
</pre></div>
</div>
</section>
</section>
<section id="polling-loop-template">
<h2>Polling loop template<a class="headerlink" href="#polling-loop-template" title="Link to this heading">¶</a></h2>
<p>After the first full processing pass (Task 1), add the following loop. Replace the
<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">REPROCESS</span> <span class="pre">FILES</span> <span class="pre">HERE</span></code> section with your Task 1 logic (count users, emit <code class="docutils literal notranslate"><span class="pre">INFO</span></code> rows per file, etc.).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Capture initial directory timestamp right after the first full processing.</span>
<span class="nv">last_ts</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dir_timestamp<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATA_DIR</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="k">while</span><span class="w"> </span>:<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="nv">now_ts</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dir_timestamp<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATA_DIR</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">((</span><span class="w"> </span>now_ts<span class="w"> </span>&gt;<span class="w"> </span>last_ts<span class="w"> </span><span class="o">))</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="c1"># Change detected → log reload warning, re-run Task 1 processing.</span>

<span class="w">    </span><span class="c1"># REPROCESS FILES HERE (your Task 1 logic that appends INFO lines per file)</span>
<span class="w">    </span><span class="c1"># ------------------------------------------------------------------------</span>
<span class="w">    </span><span class="nv">last_ts</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$now_ts</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<p>You may use the polling template and <code class="docutils literal notranslate"><span class="pre">dir_timestamp</span></code> code in your solution.</p>
</section>
<section id="sample-runs">
<h2>Sample Runs<a class="headerlink" href="#sample-runs" title="Link to this heading">¶</a></h2>
<p>If you were to run the following <code class="docutils literal notranslate"><span class="pre">p1.sh</span></code> script with the provided data directory as such</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>./p1.sh<span class="w"> </span>./data<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p>then your <code class="docutils literal notranslate"><span class="pre">./data/log.csv</span></code> will contain the following after processing the files</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Timestamp,LogLevel,Status,Message</span>
<span class="go">2024-10-19 11:10:34,WARN,[START], Script starting...</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
</pre></div>
</div>
<p>If we were to bring the script’s process into the fg and then terminate it with <code class="docutils literal notranslate"><span class="pre">CTRL+C</span></code> as such</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">fg</span>
<span class="go">^C</span>
</pre></div>
</div>
<p>then your <code class="docutils literal notranslate"><span class="pre">./data/log.csv</span></code> will still contain the following</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Timestamp,LogLevel,Status,Message</span>
<span class="go">2024-10-19 11:10:34,WARN,[START], Script starting...</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
</pre></div>
</div>
<p>If we were to start the program again using the same <code class="docutils literal notranslate"><span class="pre">data</span></code> directory as such</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>./p1.sh<span class="w"> </span>./data<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p>then your <code class="docutils literal notranslate"><span class="pre">./data/log.csv</span></code> will contain the following after processing the files</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Timestamp,LogLevel,Status,Message</span>
<span class="go">2024-10-19 11:10:34,WARN,[START], Script starting...</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
<span class="go">2024-10-19 11:12:25,WARN,[START], Script starting...</span>
<span class="go">2024-10-19 11:13:25,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:14:00,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
</pre></div>
</div>
<p>The entries append on to the log file since the <code class="docutils literal notranslate"><span class="pre">./data/log.csv</span></code> already exists.</p>
<p>To verify your live-reload loop works, do the following inside the <code class="docutils literal notranslate"><span class="pre">./data</span></code> directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>touch<span class="w"> </span>./data/data00
</pre></div>
</div>
<p>We are use to using <code class="docutils literal notranslate"><span class="pre">touch</span></code> command to create empty files; however, if the file already exists then <a href="#id3"><span class="problematic" id="id4">``</span></a>touch``updates the modification time of that file (without changing its contents) to time when the command was run.</p>
<p>Within about one second, your script should detect the change and append a reload warning to
<code class="docutils literal notranslate"><span class="pre">./data/log.csv</span></code>, followed by a fresh set of <code class="docutils literal notranslate"><span class="pre">INFO</span></code> entries for each file it reprocessed. Now the <code class="docutils literal notranslate"><span class="pre">./data/log.csv</span></code> will look like the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Timestamp,LogLevel,Status,Message</span>
<span class="go">2024-10-19 11:10:34,WARN,[START], Script starting...</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:10:34,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
<span class="go">2024-10-19 11:12:25,WARN,[START], Script starting...</span>
<span class="go">2024-10-19 11:13:25,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:14:00,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
<span class="go">2024-10-19 11:10:34,WARN,[RELOAD],Script reloading...</span>
<span class="go">2024-10-19 11:13:25,INFO,[FILE=data/data00],&quot;lamonts 3,maxg 3,sallyf+ 2,root 1&quot;</span>
<span class="go">2024-10-19 11:14:00,INFO,[FILE=data/data01],&quot;lamonts 1&quot;</span>
</pre></div>
</div>
<p><strong>Note</strong>:Many filesystems update <code class="docutils literal notranslate"><span class="pre">mtime</span></code> with <strong>1-second granularity</strong>. With a <code class="docutils literal notranslate"><span class="pre">sleep</span> <span class="pre">1</span></code> loop, your reload may appear on the next iteration.</p>
<section id="test-cases">
<h3>Test cases<a class="headerlink" href="#test-cases" title="Link to this heading">¶</a></h3>
<p>As always, Professor Samuels will provide testcases on Monday of Week 5 to help test your code.</p>
</section>
<section id="grading">
<h3>Grading<a class="headerlink" href="#grading" title="Link to this heading">¶</a></h3>
<p>Programming assignments will be graded according to a general rubric. Specifically, we will assign points for completeness, correctness, design, and style. (For more details on the categories, see our Assignment Rubric page.)</p>
<p>The exact weights for each category will vary from one assignment to another. For this assignment, the weights will be:</p>
<ul class="simple">
<li><p><strong>Completeness</strong>: 70%</p></li>
<li><p><strong>Correctness</strong>: 20%</p></li>
<li><p><strong>Design/Style</strong>: 10%</p></li>
</ul>
</section>
<section id="submission">
<h3>Submission<a class="headerlink" href="#submission" title="Link to this heading">¶</a></h3>
<p>Before submitting, make sure you’ve added, committed, and pushed all your code to GitHub. You must submit your final work through Gradescope (linked from our Canvas site) in the “Homework #3” assignment page by linking your Github account to your Gradescope account and upload the correct repository based on the homework assignment. When you submit your homework, a pop window will appear. Click on “Github” and then  “Connect to Github” to connect your Github account to Gradescope. Once you connect (you will only need to do this once), then you can select the repository you wish to upload and the branch (which should always be “main” or “master”) for this course.</p>
<p>Depending on the assignment, once you submit your work, an “autograder” will run. This autograder should produce the same test results as when you run the code yourself; if it doesn’t, please let us know so we can look into it. A few other notes:</p>
<ul class="simple">
<li><p>You are allowed to make as many submissions as you want before the deadline.</p></li>
<li><p>Please make sure you have read and understood our <a class="reference internal" href="../../syllabus.html#late-submissions"><span class="std std-ref">Late Submission Policy</span></a>.</p></li>
<li><p>Your completeness score is determined solely based on the automated tests, but we may adjust your score if you attempt to pass tests by rote (e.g., by writing code that hard-codes the expected output for each possible test input).</p></li>
<li><p>Gradescope will report the test score it obtains when running your code. If there is a discrepancy between the score you get when running our grader script, and the score reported by Gradescope, please let us know so we can take a look at it.</p></li>
</ul>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021-2025, University of Chicago.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.3.7.<br/>
    </p>
  </div>
</footer>
  </body>
</html>